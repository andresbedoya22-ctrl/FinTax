# Pentest Checklist (Roadmap ยง28.1)

## 20-point checklist
1. Verify HTTPS/TLS configuration and HSTS behavior.
2. Validate security headers on all critical routes.
3. Confirm auth bypass is not possible on admin flows.
4. Confirm MFA enforcement for admin access.
5. Validate session cookie flags (`httpOnly`, `secure`, `sameSite`).
6. Test CSRF/origin protections on state-changing endpoints.
7. Test IDOR on case/document/payment resources.
8. Validate RLS prevents cross-tenant reads/writes.
9. Verify webhook signature validation and replay handling.
10. Verify rate-limiting and abuse throttling on public endpoints.
11. Test file upload content-type and extension validation.
12. Test malicious payload handling in uploads.
13. Validate secrets are not exposed in client bundles/logs.
14. Verify PII redaction in logs and observability.
15. Confirm encryption at rest usage for sensitive identifiers.
16. Test dependency vulnerability baseline (`audit` high/critical).
17. Validate license policy enforcement for disallowed licenses.
18. Verify error envelopes do not leak stack traces in prod.
19. Confirm backup/restore controls are documented and tested.
20. Validate rollback procedure execution readiness.

## Abuse tests (minimum 5)
1. Replayed Stripe webhook event with identical signature payload.
2. Cross-account case ID access attempt from authenticated user.
3. Mass unauthenticated requests against `/api/notifications` and `/api/cases`.
4. Oversized / malformed document upload payload.
5. Auth callback tampering attempt with modified query parameters.

## Evidence template
- Test date (UTC):
- Tester:
- Environment:
- Result summary:
- Critical findings:
- Medium findings:
- Follow-up owner:
