# PR #07 Log (append-only)

## Scope
- BSN key versioning + crypto lifecycle hardening.
- Persistencia de BSN con `key_id` + `ciphertext`.
- Compatibilidad con payload legado `bsn_encrypted`.
- Rutina de re-encrypt para rotación de llaves.

## Assumption
- El roadmap no expone una etiqueta textual "PR #07" en el artefacto extraído.
- Se toma como siguiente alcance mínimo el gate técnico de key versioning de BSN (en v9 aparece mapeado como PR #8A), ejecutado en secuencia como PR #07 para mantener continuidad.

## Changed files
- `supabase/migrations/005_bsn_key_versioning.sql`
- `src/lib/security/encryption.ts`
- `src/app/api/cases/draft/route.ts`
- `src/types/database.ts`
- `src/lib/mock-data.ts`
- `scripts/bsn-reencrypt.mjs`
- `tests/encryption-roundtrip.test.mjs`
- `package.json`
